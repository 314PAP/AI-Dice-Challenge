<!DOCTYPE html>
<html lang="cs">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>AI Dice Challenge - Test v≈°ech oprav</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            padding: 20px;
            background: #000;
            color: #fff;
        }
        .test-section {
            margin: 20px 0;
            padding: 15px;
            border: 1px solid #333;
            border-radius: 5px;
        }
        .pass { color: #0f0; }
        .fail { color: #f00; }
        .info { color: #00f; }
        button {
            margin: 10px 5px;
            padding: 10px 15px;
            background: #333;
            color: #fff;
            border: none;
            border-radius: 5px;
            cursor: pointer;
        }
        button:hover {
            background: #555;
        }
        pre {
            background: #222;
            padding: 10px;
            border-radius: 5px;
            overflow-x: auto;
        }
    </style>
</head>
<body>
    <h1>üé≤ AI Dice Challenge - Test v≈°ech oprav</h1>
    
    <div class="test-section">
        <h2>1. Test AI bankovn√≠ logiky</h2>
        <p>Testujeme, zda AI hr√°ƒçi spr√°vnƒõ bankuj√≠ body podle opraven√© logiky:</p>
        <button onclick="testAIBankingLogic()">Test AI Banking</button>
        <pre id="banking-results"></pre>
    </div>

    <div class="test-section">
        <h2>2. Test aktivn√≠ho hr√°ƒçe indik√°toru</h2>
        <p>Testujeme, zda se spr√°vnƒõ zv√Ωraz≈àuje aktivn√≠ hr√°ƒç:</p>
        <button onclick="testActivePlayerIndicator()">Test Active Player</button>
        <pre id="active-player-results"></pre>
    </div>

    <div class="test-section">
        <h2>3. Test FARKLE zpr√°vy</h2>
        <p>Testujeme, zda se zobrazuje FARKLE zpr√°va nad avatarem:</p>
        <button onclick="testFarkleMessage()">Test FARKLE Message</button>
        <pre id="farkle-results"></pre>
    </div>

    <div class="test-section">
        <h2>4. Test glob√°ln√≠ch funkc√≠</h2>
        <p>Testujeme, zda jsou v≈°echny pot≈ôebn√© funkce dostupn√© glob√°lnƒõ:</p>
        <button onclick="testGlobalFunctions()">Test Global Functions</button>
        <pre id="global-results"></pre>
    </div>

    <script type="module">
        // Import testovan√Ωch modul≈Ø
        import { getBankingDecision } from '/src/js/ai/aiPlayer.js';
        import { updateActivePlayer } from '/src/js/ui/components/scoreboard.js';
        import { showFarkleMessage } from '/src/js/ui/speechBubbles.js';

        // Simulovan√© game state
        const mockGameState = {
            currentPlayer: 0,
            players: [
                { name: 'Human', isAI: false, hasEnteredGame: false, score: 0, currentTurnScore: 0 },
                { name: 'GPT-4', type: 'strategic', isAI: true, hasEnteredGame: false, score: 0, currentTurnScore: 0 },
                { name: 'Gemini', type: 'balanced', isAI: true, hasEnteredGame: false, score: 0, currentTurnScore: 0 },
                { name: 'Claude', type: 'cautious', isAI: true, hasEnteredGame: false, score: 0, currentTurnScore: 0 }
            ]
        };

        // Test AI Banking Logic
        window.testAIBankingLogic = function() {
            const results = document.getElementById('banking-results');
            let output = 'Testing AI Banking Logic:\n\n';

            try {
                // Test 1: Prvn√≠ vstup do hry - mus√≠ b√Ωt 300+
                mockGameState.players[1].hasEnteredGame = false;
                mockGameState.players[1].currentTurnScore = 250;
                let decision = getBankingDecision(mockGameState.players[1]);
                output += `Test 1 - Prvn√≠ vstup (250 bod≈Ø): ${!decision.shouldBank ? '‚úÖ PASS' : '‚ùå FAIL'} - Nebankovalo (spr√°vnƒõ)\n`;

                mockGameState.players[1].currentTurnScore = 350;
                decision = getBankingDecision(mockGameState.players[1]);
                output += `Test 1b - Prvn√≠ vstup (350 bod≈Ø): ${decision.shouldBank ? '‚úÖ PASS' : '‚ùå FAIL'} - Bankovalo (spr√°vnƒõ)\n`;

                // Test 2: Po prvn√≠m vstupu - m≈Ø≈æe bankovat cokoliv
                mockGameState.players[1].hasEnteredGame = true;
                mockGameState.players[1].currentTurnScore = 150;
                decision = getBankingDecision(mockGameState.players[1]);
                output += `Test 2 - Po prvn√≠m vstupu (150 bod≈Ø): ${decision.shouldBank ? '‚úÖ PASS' : '‚ùå FAIL'} - Bankovalo (spr√°vnƒõ)\n`;

                // Test 3: R≈Øzn√© AI typy
                const aiTypes = ['strategic', 'balanced', 'cautious'];
                aiTypes.forEach((type, index) => {
                    const aiPlayer = { ...mockGameState.players[index + 1], type, hasEnteredGame: true, currentTurnScore: 300 };
                    const decision = getBankingDecision(aiPlayer);
                    output += `Test 3${String.fromCharCode(97 + index)} - ${type} AI (300 bod≈Ø): ${decision.shouldBank ? '‚úÖ PASS' : '‚ùå FAIL'} - Rozhodnut√≠: ${decision.shouldBank}\n`;
                });

                output += '\n‚úÖ V≈°echny testy AI bankovn√≠ logiky pro≈°ly!';
                results.className = 'pass';
            } catch (error) {
                output += `\n‚ùå CHYBA: ${error.message}`;
                results.className = 'fail';
            }

            results.textContent = output;
        };

        // Test Active Player Indicator
        window.testActivePlayerIndicator = function() {
            const results = document.getElementById('active-player-results');
            let output = 'Testing Active Player Indicator:\n\n';

            try {
                // Simuluj HTML strukturu
                const gameContainer = document.createElement('div');
                gameContainer.innerHTML = `
                    <div class="human-player">
                        <div class="player-avatar"></div>
                        <h3>Human</h3>
                    </div>
                    <div class="gpt-player">
                        <div class="player-avatar"></div>
                        <h3>GPT-4</h3>
                    </div>
                    <div class="gemini-player">
                        <div class="player-avatar"></div>
                        <h3>Gemini</h3>
                    </div>
                    <div class="claude-player">
                        <div class="player-avatar"></div>
                        <h3>Claude</h3>
                    </div>
                `;
                document.body.appendChild(gameContainer);

                // Test r≈Øzn√© aktivn√≠ hr√°ƒçe
                for (let i = 0; i < 4; i++) {
                    mockGameState.currentPlayer = i;
                    updateActivePlayer();
                    
                    const playerClasses = ['human-player', 'gpt-player', 'gemini-player', 'claude-player'];
                    const activeElement = document.querySelector(`.${playerClasses[i]}.active-player`);
                    
                    output += `Test ${i + 1} - Aktivn√≠ hr√°ƒç ${i}: ${activeElement ? '‚úÖ PASS' : '‚ùå FAIL'} - ${playerClasses[i]} ${activeElement ? 'm√°' : 'nem√°'} active-player t≈ô√≠du\n`;
                }

                gameContainer.remove();
                output += '\n‚úÖ V≈°echny testy aktivn√≠ho hr√°ƒçe pro≈°ly!';
                results.className = 'pass';
            } catch (error) {
                output += `\n‚ùå CHYBA: ${error.message}`;
                results.className = 'fail';
            }

            results.textContent = output;
        };

        // Test FARKLE Message
        window.testFarkleMessage = function() {
            const results = document.getElementById('farkle-results');
            let output = 'Testing FARKLE Message:\n\n';

            try {
                // Simuluj HTML strukturu
                const gameContainer = document.createElement('div');
                gameContainer.innerHTML = `
                    <div class="human-player">
                        <div class="player-avatar">
                            <div class="avatar-circle">üë§</div>
                        </div>
                        <h3>Human</h3>
                    </div>
                    <div class="gpt-player">
                        <div class="player-avatar">
                            <div class="avatar-circle">ü§ñ</div>
                        </div>
                        <h3>GPT-4</h3>
                    </div>
                `;
                document.body.appendChild(gameContainer);

                // Test FARKLE zpr√°vy pro r≈Øzn√© hr√°ƒçe
                showFarkleMessage(0); // Human
                let farkleElement = document.querySelector('.farkle-message');
                output += `Test 1 - FARKLE pro Human: ${farkleElement ? '‚úÖ PASS' : '‚ùå FAIL'} - ${farkleElement ? 'Zpr√°va zobrazena' : 'Zpr√°va nezobrazena'}\n`;

                setTimeout(() => {
                    showFarkleMessage(1); // GPT-4
                    farkleElement = document.querySelector('.farkle-message');
                    output += `Test 2 - FARKLE pro GPT-4: ${farkleElement ? '‚úÖ PASS' : '‚ùå FAIL'} - ${farkleElement ? 'Zpr√°va zobrazena' : 'Zpr√°va nezobrazena'}\n`;

                    gameContainer.remove();
                    output += '\n‚úÖ V≈°echny testy FARKLE zpr√°vy pro≈°ly!';
                    results.textContent = output;
                    results.className = 'pass';
                }, 100);
            } catch (error) {
                output += `\n‚ùå CHYBA: ${error.message}`;
                results.className = 'fail';
                results.textContent = output;
            }
        };

        // Test Global Functions
        window.testGlobalFunctions = function() {
            const results = document.getElementById('global-results');
            let output = 'Testing Global Functions:\n\n';

            try {
                const requiredFunctions = [
                    'addChatMessage',
                    'selectDie', 
                    'displayHallOfFame',
                    'closeHallOfFame',
                    'saveScore',
                    'startNewGame',
                    'returnToMainMenu',
                    'endAITurn',
                    'showFarkleMessage'
                ];

                requiredFunctions.forEach(funcName => {
                    const exists = typeof window[funcName] === 'function';
                    output += `${funcName}: ${exists ? '‚úÖ PASS' : '‚ùå FAIL'} - ${exists ? 'Dostupn√°' : 'Nedostupn√°'}\n`;
                });

                output += '\n‚úÖ V≈°echny glob√°ln√≠ funkce jsou dostupn√©!';
                results.className = 'pass';
            } catch (error) {
                output += `\n‚ùå CHYBA: ${error.message}`;
                results.className = 'fail';
            }

            results.textContent = output;
        };

        // Automatick√Ω test p≈ôi naƒçten√≠ str√°nky
        setTimeout(() => {
            console.log('üß™ Spou≈°t√≠m automatick√© testy...');
            testGlobalFunctions();
        }, 1000);
    </script>
</body>
</html>
