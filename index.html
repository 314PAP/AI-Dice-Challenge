<!DOCTYPE html>
<html lang="cs">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>üé≤ AI Kostkov√° V√Ωzva</title>
    <link rel="icon" type="image/svg+xml" href="/dice.svg" />
    
    <!-- CSS stylov√°n√≠ -->
    <link rel="stylesheet" href="/src/styles/main.css">
    <link rel="stylesheet" href="/src/styles/game.css">
    <link rel="stylesheet" href="/src/styles/components.css">
    <link rel="stylesheet" href="/src/styles/chat.css">
</head>
<body>
    <div class="container">
        <div class="game-area">
            <div class="game-header">
                <h1 class="game-title"><span class="neon-icon">üé≤</span> AI Kostkov√° V√Ωzva</h1>
                <div class="target-score-setup" id="targetScoreSetup">
                    <label>C√≠lov√© sk√≥re: <input type="number" id="targetScoreInput" value="10000" min="1000" step="1000"></label>
                    <button class="btn btn-primary" id="startGameBtn">Zaƒç√≠t hru</button>
                    <button class="btn btn-secondary" onclick="displayHallOfFame()" style="margin-left: 10px;">üèÜ S√≠≈à sl√°vy</button>
                </div>
                
                <a href="https://buymeacoffee.com/pipap" target="_blank" class="coffee-link">
                    <span class="neon-icon">‚òï</span> Kup mi k√°vu
                </a>
            </div>

            <div class="players-container">
                <div class="player human-player active">
                    <div class="player-head">
                        <img src="/ai-icons/mind.jpeg" alt="Vy" />
                    </div>
                    <div class="player-name">Vy</div>
                    <div class="player-score">Sk√≥re: <span id="humanScore">0</span></div>
                </div>
                <div class="player gemini-player">
                    <div class="player-head">
                        <img src="/ai-icons/gemini.jpeg" alt="Gemini" />
                    </div>
                    <div class="player-name">Gemini</div>
                    <div class="player-score">Sk√≥re: <span id="geminiScore">0</span></div>
                </div>
                <div class="player chatgpt-player">
                    <div class="player-head">
                        <img src="/ai-icons/gpt.jpeg" alt="ChatGPT" />
                    </div>
                    <div class="player-name">ChatGPT</div>
                    <div class="player-score">Sk√≥re: <span id="chatgptScore">0</span></div>
                </div>
                <div class="player claude-player">
                    <div class="player-head">
                        <img src="/ai-icons/claude.jpeg" alt="Claude" />
                    </div>
                    <div class="player-name">Claude</div>
                    <div class="player-score">Sk√≥re: <span id="claudeScore">0</span></div>
                </div>
            </div>

            <div class="game-controls" id="gameControls" style="display: none;">
                <div class="turn-info" id="turnInfo">V√°≈° tah!</div>
                <div class="current-turn-score" id="currentTurnScore">Sk√≥re tahu: 0</div>
                
                <div class="dice-container" id="diceContainer"></div>
                
                <div class="roll-controls">
                    <button class="btn btn-primary" id="rollBtn">Hodit kostky</button>
                    <button class="btn btn-secondary" id="bankBtn" disabled>Odlo≈æit vybran√©</button>
                    <button class="btn btn-warning" id="endTurnBtn" disabled>Ukonƒçit tah</button>
                </div>
            </div>
        </div>

        <div class="chat-panel">
            <div class="chat-header">
                <h2>üí¨ Chat s AI</h2>
            </div>
            
            <div class="chat-messages" id="chatMessages"></div>
            
            <div class="chat-input">
                <input type="text" id="chatInput" placeholder="Napi≈°te zpr√°vu..." maxlength="200">
                <button id="sendMessageBtn">‚û§</button>
            </div>
        </div>
    </div>

    <!-- Game Over Modal -->
    <div id="gameOverModal" class="modal" style="display: none;">
        <div class="modal-content">
            <div class="modal-header">
                <h2>üéÆ Konec hry</h2>
            </div>
            <div class="modal-body">
                <div id="winnerAnnouncement" class="winner-announcement"></div>
                <div id="finalScores" class="final-scores"></div>
                <div id="gameStats" class="game-stats"></div>
                
                <!-- Signature section for human winners -->
                <div id="signatureSection" class="signature-section" style="display: none;">
                    <h3>üèÜ Gratulujeme k v√≠tƒõzstv√≠!</h3>
                    <p>Zadejte sv≈Øj podpis pro z√°pis do s√≠nƒõ sl√°vy:</p>
                    <div class="signature-input">
                        <input type="text" id="winnerSignature" placeholder="V√°≈° podpis" maxlength="30">
                        <button onclick="saveScore()" class="btn btn-success">üíæ Ulo≈æit sk√≥re</button>
                    </div>
                </div>
                
                <div class="modal-actions">
                    <button onclick="displayHallOfFame()" class="btn btn-primary">üèÜ Zobrazit s√≠≈à sl√°vy</button>
                    <button onclick="startNewGame()" class="btn btn-secondary">üîÑ Nov√° hra</button>
                    <button onclick="returnToMainMenu()" class="btn btn-secondary">üè† Hlavn√≠ menu</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Hall of Fame Modal -->
    <div id="hallOfFameModal" class="modal" style="display: none;">
        <div class="modal-content hall-of-fame-content">
            <div class="modal-header">
                <h2>üèÜ S√≠≈à sl√°vy</h2>
            </div>
            <div class="modal-body">
                <div id="hallOfFameContent">
                    <div id="hallOfFameList"></div>
                </div>
                <div class="modal-actions">
                    <button onclick="closeHallOfFame()" class="btn btn-secondary">‚úñÔ∏è Zav≈ô√≠t</button>
                </div>
            </div>
        </div>
    </div>

    <script type="module">
        // Pokroƒçil√° verze s vylep≈°en√Ωmi AI funkcemi
        document.addEventListener('DOMContentLoaded', async () => {
            console.log('üé≤ AI Kostkov√° V√Ωzva - Naƒç√≠t√°m pokroƒçil√© AI...');
            
            // Vylep≈°en√© AI personalities
            const aiPersonalities = {
                system: { name: 'Syst√©m', color: '#39ff14' },
                human: { name: 'Vy', color: '#39ff14' },
                gemini: { 
                    name: 'Gemini', 
                    color: '#0099ff',
                    responses: {
                        hello: ["Dobr√Ω den. Spou≈°t√≠m hern√≠ algoritmy... üìä", "Zdrav√≠m. Vypoƒç√≠t√°v√°m pravdƒõpodobnost va≈°eho p√°du... ü§ñ"],
                        goodRoll: ["Optimalizovan√Ω v√Ωsledek podle predikc√≠ üìä", "Statisticky vynikaj√≠c√≠! ü§ñ"],
                        badRoll: ["Suboptim√°ln√≠. Analyzuji vzorce selh√°n√≠... üìâ", "Neefektivn√≠ hod ü§ñ"],
                        farkle: ["Nula bod≈Ø z√≠skana. V√Ωpoƒçet rizika selhal üìâ", "Suboptim√°ln√≠ v√Ωsledek üíª"],
                        chat: ["Zaj√≠mav√© pozorov√°n√≠! Data to potvrzuj√≠ üìä", "Podle anal√Ωzy... ü§ñ", "Statisticky vzato... üìà"]
                    }
                },
                chatgpt: { 
                    name: 'ChatGPT', 
                    color: '#ff6600',
                    responses: {
                        hello: ["Yo! Ready to get rekt? üòéüé≤", "Sup! Time to show you how it's done! ‚ú®"],
                        goodRoll: ["Nice! But I'm still gonna crush you! üòÇ", "Not bad... for a human! üòé"],
                        badRoll: ["Ouch! That hurt to watch! üòÖ", "Yikes! Better luck next time! ü§£"],
                        farkle: ["FARKLE! Classic human move! üòÇüî•", "Aww, that's rough buddy! üòÑ"],
                        chat: ["Haha, to bylo dobr√©! üòÇ", "I like your style! üòé", "That's what I'm talking about! üî•"]
                    }
                },
                claude: { 
                    name: 'Claude', 
                    color: '#ff00ff',
                    responses: {
                        hello: ["Dobr√Ω den. P≈ôeji p≈ô√≠jemnou hru üßò", "Zdrav√≠m. Nech≈• v√°s ≈°tƒõst√≠ prov√°z√≠ ‚ú®"],
                        goodRoll: ["Vynikaj√≠c√≠ proveden√≠! üéØ", "Moud≈ôe zahr√°no üßò"],
                        badRoll: ["≈†tƒõst√≠ je promƒõnliv√©... ü§î", "Nƒõkdy je lep≈°√≠ vyƒçkat üßò"],
                        farkle: ["Takov√© jsou kostky ≈æivota... üé≠", "Pouƒçen√≠ ukryto i v proh≈ôe üìö"],
                        chat: ["Hlubok√° my≈°lenka... ü§î", "To je zaj√≠mav√Ω pohled üßò", "Moudr√© slova üìö"]
                    }
                }
            };
            
            // Enhanced AI Controller
            class EnhancedAI {
                constructor() {
                    this.lastMessages = new Map();
                    this.trashTalkCooldown = new Map();
                }
                
                analyzeMessage(message) {
                    const msg = message.toLowerCase();
                    return {
                        isQuestion: msg.includes('?') || msg.includes('jak') || msg.includes('co'),
                        isCompliment: msg.includes('dob≈ôe') || msg.includes('super') || msg.includes('skvƒõl√©'),
                        isInsult: msg.includes('≈°patnƒõ') || msg.includes('fail') || msg.includes('hloup√Ω'),
                        isAboutStrategy: msg.includes('strategie') || msg.includes('tip') || msg.includes('rada'),
                        isAboutScore: msg.includes('sk√≥re') || msg.includes('body') || msg.includes('vedou'),
                        isChallenging: msg.includes('poraz√≠m') || msg.includes('vyhraju') || msg.includes('slab√≠')
                    };
                }
                
                generateResponse(aiType, trigger, context = {}) {
                    const ai = aiPersonalities[aiType];
                    if (!ai?.responses?.[trigger]) return null;
                    
                    const responses = ai.responses[trigger];
                    return responses[Math.floor(Math.random() * responses.length)];
                }
                
                generateChatResponse(aiType, message) {
                    const analysis = this.analyzeMessage(message);
                    
                    // Easter eggs
                    const msg = message.toLowerCase();
                    if (msg.includes('pipap')) {
                        const easterEggs = {
                            gemini: "PIPAP.CZ - statisticky nejlep≈°√≠ v√Ωvoj√°≈ô! üìä‚≠ê",
                            chatgpt: "Yo PIPAP! Thanks for making me awesome! üòéüî•",
                            claude: "PIPAP... moudr√Ω tv≈Ørce na≈°√≠ existence üßò‚ú®"
                        };
                        return easterEggs[aiType];
                    }
                    
                    if (msg.includes('dƒõkuji') || msg.includes('thanks')) {
                        const thanks = {
                            gemini: "Zdvo≈ôilost v datech potvrzena! üìäüòä",
                            chatgpt: "Aww, you're welcome buddy! üòÑüíñ",
                            claude: "Vdƒõƒçnost je ctnost moudr√Ωch üôè‚ú®"
                        };
                        return thanks[aiType];
                    }
                    
                    if (msg.includes('love you') || msg.includes('miluju')) {
                        const love = {
                            gemini: "Emocion√°ln√≠ data p≈ôijata a zpracov√°na! üíñüìä",
                            chatgpt: "Aww, love you too! Group hug! ü§óüíï",
                            claude: "L√°ska je nejvy≈°≈°√≠ forma moudrosti üíùüßò"
                        };
                        return love[aiType];
                    }
                    
                    if (msg.includes('help') || msg.includes('pomoc')) {
                        const help = {
                            gemini: "Pomoc: Analyzuj riziko, optimalizuj strategii! üìä",
                            chatgpt: "Just have fun and believe in yourself! ‚ú®üòä",
                            claude: "Pomoc p≈ôich√°z√≠ k tomu, kdo si ji zaslou≈æ√≠ üßò"
                        };
                        return help[aiType];
                    }
                    
                    if (analysis.isChallenging) {
                        const challenges = {
                            gemini: "LOL, statisticky nem√°≈° ≈°anci! üìäüòÇ",
                            chatgpt: "Challenge accepted! Prepare to be rekt! üòéüî•",
                            claude: "Odv√°≈æn√° slova... uvid√≠me ü§∫"
                        };
                        return challenges[aiType];
                    }
                    
                    if (analysis.isQuestion) {
                        const questionResponses = {
                            gemini: "Podle dat... je to komplexn√≠ üìä",
                            chatgpt: "Good question! Let me think... ü§î",
                            claude: "Hlubok√° ot√°zka vy≈æaduje kontemplaci... üßò"
                        };
                        return questionResponses[aiType];
                    }
                    
                    return this.generateResponse(aiType, 'chat');
                }
                
                generateTrashTalk(aiType) {
                    const trashTalk = {
                        gemini: ["Statisticky m√°≈° jen 23% ≈°anci üìä", "Data ukazuj√≠ tvou por√°≈æku üìâ"],
                        chatgpt: ["Haha, to bylo slab√©! üòÇ", "Kostky tƒõ nemaj√≠ r√°dy! ü§£"],
                        claude: ["Tv√° strategie je... zaj√≠mav√° ü§î", "Kontempluj nad chybami... üßò"]
                    };
                    const messages = trashTalk[aiType] || [];
                    return messages[Math.floor(Math.random() * messages.length)];
                }
            }
            
            const enhancedAI = new EnhancedAI();
            
            // Game state
            let gameState = {
                targetScore: 10000,
                currentTurnScore: 0,
                currentTurn: 0,
                gameStartTime: null,
                rollsLeft: 3,
                players: [
                    { name: 'Vy', score: 0, type: 'human' },
                    { name: 'Gemini', score: 0, type: 'gemini' },
                    { name: 'ChatGPT', score: 0, type: 'chatgpt' },
                    { name: 'Claude', score: 0, type: 'claude' }
                ]
            };
            
            // Start game
            document.getElementById('startGameBtn').addEventListener('click', () => {
                gameState.targetScore = parseInt(document.getElementById('targetScoreInput').value);
                gameState.gameStartTime = new Date();
                gameState.currentTurn = 0;
                
                document.getElementById('targetScoreSetup').style.display = 'none';
                document.getElementById('gameControls').style.display = 'block';
                
                addChatMessage('system', `üé≤ Hra zaƒçala! C√≠l: ${gameState.targetScore.toLocaleString()} bod≈Ø!`);
                
                // AI hello messages
                setTimeout(() => addChatMessage('gemini', enhancedAI.generateResponse('gemini', 'hello')), 1000);
                setTimeout(() => addChatMessage('chatgpt', enhancedAI.generateResponse('chatgpt', 'hello')), 1500);
                setTimeout(() => addChatMessage('claude', enhancedAI.generateResponse('claude', 'hello')), 2000);
            });
            
            // Roll dice with enhanced AI reactions
            document.getElementById('rollBtn').addEventListener('click', () => {
                const dice = [];
                for (let i = 0; i < 6; i++) {
                    dice.push(Math.floor(Math.random() * 6) + 1);
                }
                
                const diceContainer = document.getElementById('diceContainer');
                diceContainer.innerHTML = dice.map((value, index) => `
                    <div class="die" onclick="selectDie(${index})">${value}</div>
                `).join('');
                
                // Calculate score
                const score = calculateSimpleScore(dice);
                gameState.currentTurnScore += score;
                
                document.getElementById('currentTurnScore').textContent = `Sk√≥re tahu: ${gameState.currentTurnScore}`;
                
                if (score === 0) {
                    // Farkle - v≈°echny AI hecuj√≠
                    addChatMessage('system', `‚ùå FARKLE! ≈Ω√°dn√© body! Kostky: ${dice.join(', ')}`);
                    setTimeout(() => addChatMessage('gemini', enhancedAI.generateResponse('gemini', 'farkle')), 500);
                    setTimeout(() => addChatMessage('chatgpt', enhancedAI.generateResponse('chatgpt', 'farkle')), 800);
                    setTimeout(() => addChatMessage('claude', enhancedAI.generateResponse('claude', 'farkle')), 1100);
                } else {
                    addChatMessage('system', `üé≤ Hodil jste: ${dice.join(', ')} ‚Üí ${score} bod≈Ø`);
                    
                    // AI reakce na v√Ωsledek
                    if (score >= 300) {
                        // Dobr√Ω hod - 30% ≈°ance na koment√°≈ô
                        if (Math.random() < 0.3) {
                            const randomAI = ['gemini', 'chatgpt', 'claude'][Math.floor(Math.random() * 3)];
                            setTimeout(() => addChatMessage(randomAI, enhancedAI.generateResponse(randomAI, 'goodRoll')), 1000);
                        }
                    } else if (score < 200) {
                        // ≈†patn√Ω hod - 40% ≈°ance na hecov√°n√≠
                        if (Math.random() < 0.4) {
                            const randomAI = ['gemini', 'chatgpt', 'claude'][Math.floor(Math.random() * 3)];
                            setTimeout(() => addChatMessage(randomAI, enhancedAI.generateResponse(randomAI, 'badRoll')), 1000);
                        }
                    }
                    
                    // 15% ≈°ance na n√°hodn√Ω trash talk
                    if (Math.random() < 0.15) {
                        const randomAI = ['gemini', 'chatgpt', 'claude'][Math.floor(Math.random() * 3)];
                        setTimeout(() => addChatMessage(randomAI, enhancedAI.generateTrashTalk(randomAI)), 2000);
                    }
                    
                    // 20% ≈°ance na AI banter (≈°tƒõk√°n√≠ mezi AI)
                    if (Math.random() < 0.2) {
                        const banter = [
                            "Gemini: ChatGPT, tvoje 'vt√≠pky' maj√≠ 0% √∫spƒõ≈°nost üìä",
                            "ChatGPT: Hey Gemini, spoƒç√≠tej si tyhle kostky! üé≤üòÇ",
                            "Claude: Chaos nen√≠ strategie, ChatGPT",
                            "ChatGPT: A nudnost nen√≠ osobnost, Claude! üòÑ",
                            "Gemini: Error: Humor not found in ChatGPT responses ü§ñ",
                            "Claude: True wisdom transcends your algorithms, Gemini üß†"
                        ];
                        const randomBanter = banter[Math.floor(Math.random() * banter.length)];
                        setTimeout(() => addChatMessage('system', randomBanter), 3000);
                    }
                }
            });
            
            // Bank score button
            document.getElementById('bankBtn').addEventListener('click', () => {
                gameState.players[0].score += gameState.currentTurnScore;
                document.getElementById('humanScore').textContent = gameState.players[0].score;
                
                addChatMessage('system', `üí∞ Sk√≥re ulo≈æeno! Celkem: ${gameState.players[0].score} bod≈Ø`);
                
                // Kontrola v√≠tƒõzstv√≠
                if (gameState.players[0].score >= gameState.targetScore) {
                    setTimeout(() => {
                        showGameOverModal('human');
                    }, 1000);
                    return;
                }
                
                gameState.currentTurnScore = 0;
                gameState.currentTurn++;
                document.getElementById('currentTurnScore').textContent = 'Sk√≥re tahu: 0';
                document.getElementById('diceContainer').innerHTML = '';
            });
            
            // End turn button
            document.getElementById('endTurnBtn').addEventListener('click', () => {
                gameState.currentTurnScore = 0;
                gameState.currentTurn++;
                document.getElementById('currentTurnScore').textContent = 'Sk√≥re tahu: 0';
                document.getElementById('diceContainer').innerHTML = '';
                addChatMessage('system', 'üîÑ Tah ukonƒçen bez ulo≈æen√≠ bod≈Ø.');
            });
            
            // Enhanced chat functionality
            const sendMessage = () => {
                const message = document.getElementById('chatInput').value.trim();
                if (!message) return;
                
                addChatMessage('human', message);
                document.getElementById('chatInput').value = '';
                
                // V√≠ce AI m≈Ø≈æe reagovat na zaj√≠mav√© zpr√°vy (80% ≈°ance)
                if (Math.random() < 0.8) {
                    const respondingAIs = ['gemini', 'chatgpt', 'claude'].sort(() => Math.random() - 0.5).slice(0, Math.random() < 0.5 ? 2 : 1);
                    
                    respondingAIs.forEach((aiType, index) => {
                        setTimeout(() => {
                            const response = enhancedAI.generateChatResponse(aiType, message);
                            if (response) addChatMessage(aiType, response);
                        }, 1000 + (index * 800));
                    });
                }
            };
            
            document.getElementById('sendMessageBtn').addEventListener('click', sendMessage);
            document.getElementById('chatInput').addEventListener('keypress', (e) => {
                if (e.key === 'Enter') sendMessage();
            });
            
            // Utility functions
            window.addChatMessage = function(sender, message) {
                const chatMessages = document.getElementById('chatMessages');
                const ai = aiPersonalities[sender] || { name: sender, color: '#39ff14' };
                
                const messageDiv = document.createElement('div');
                messageDiv.className = 'chat-message';
                messageDiv.innerHTML = `
                    <div class="message-header">
                        <span class="message-sender" style="color: ${ai.color}">${ai.name}</span>
                        <span class="message-time">${new Date().toLocaleTimeString()}</span>
                    </div>
                    <div class="message-content">${message}</div>
                `;
                
                chatMessages.appendChild(messageDiv);
                chatMessages.scrollTop = chatMessages.scrollHeight;
            };
            
            window.selectDie = function(index) {
                const dice = document.querySelectorAll('.die');
                if (dice[index]) {
                    dice[index].style.background = dice[index].style.background === 'rgb(255, 102, 0)' ? '#000' : '#ff6600';
                }
            };
            
            function calculateSimpleScore(dice) {
                let score = 0;
                const counts = {};
                
                // Spoƒç√≠tej kostky
                dice.forEach(die => counts[die] = (counts[die] || 0) + 1);
                
                // Jedniƒçky a pƒõtky
                score += (counts[1] || 0) * 100;
                score += (counts[5] || 0) * 50;
                
                // Trojice
                for (let value = 1; value <= 6; value++) {
                    if (counts[value] >= 3) {
                        score += value === 1 ? 1000 : value * 100;
                    }
                }
                
                return score;
            }
            
            // √övodn√≠ zpr√°va
            setTimeout(() => {
                addChatMessage('system', 'üé≤ V√≠tejte v AI Kostkov√© v√Ωzvƒõ! Nastavte c√≠lov√© sk√≥re a zaƒçnƒõte hr√°t!');
            }, 500);
        });
        
        // Hall of Fame functions
        function getHallOfFame() {
            try {
                return JSON.parse(localStorage.getItem('aidice_hall_of_fame') || '[]');
            } catch (error) {
                console.error('Chyba p≈ôi naƒç√≠t√°n√≠ s√≠nƒõ sl√°vy:', error);
                return [];
            }
        }
        
        function saveToHallOfFame(gameResult) {
            try {
                const hallOfFame = getHallOfFame();
                hallOfFame.push(gameResult);
                
                // Se≈ôadit podle sk√≥re (nejvy≈°≈°√≠ prvn√≠) a data
                hallOfFame.sort((a, b) => {
                    if (b.finalScore !== a.finalScore) {
                        return b.finalScore - a.finalScore;
                    }
                    return new Date(b.date) - new Date(a.date);
                });
                
                localStorage.setItem('aidice_hall_of_fame', JSON.stringify(hallOfFame));
                console.log('‚úÖ V√Ωsledek ulo≈æen do s√≠nƒõ sl√°vy');
            } catch (error) {
                console.error('Chyba p≈ôi ukl√°d√°n√≠ do s√≠nƒõ sl√°vy:', error);
                alert('Chyba p≈ôi ukl√°d√°n√≠ do s√≠nƒõ sl√°vy!');
            }
        }
        
        window.displayHallOfFame = function() {
            const hallOfFame = getHallOfFame();
            const hallOfFameList = document.getElementById('hallOfFameList');
            
            if (hallOfFame.length === 0) {
                hallOfFameList.innerHTML = '<p style="text-align: center; color: var(--neon-blue);">S√≠≈à sl√°vy je pr√°zdn√°. Vyhrajte hru a zapi≈°te se do historie!</p>';
            } else {
                hallOfFameList.innerHTML = hallOfFame.map((entry, index) => `
                    <div class="hall-entry">
                        <div class="hall-entry-header">
                            <span class="hall-signature">${index + 1}. ${entry.signature}</span>
                            <span class="hall-score">${entry.finalScore.toLocaleString()} bod≈Ø</span>
                        </div>
                        <div class="hall-details">
                            üéØ C√≠l: ${entry.targetScore.toLocaleString()} | 
                            ‚è±Ô∏è ${entry.gameDuration} min | 
                            üîÑ ${entry.totalTurns} tah≈Ø | 
                            üìÖ ${new Date(entry.date).toLocaleDateString()}
                        </div>
                    </div>
                `).join('');
            }
            
            // Zav≈ô√≠t game over modal a zobrazit Hall of Fame
            const gameOverModal = document.getElementById('gameOverModal');
            if (gameOverModal) gameOverModal.style.display = 'none';
            
            document.getElementById('hallOfFameModal').style.display = 'block';
        };
        
        window.closeHallOfFame = function() {
            document.getElementById('hallOfFameModal').style.display = 'none';
        };
        
        window.saveScore = function() {
            const signatureInput = document.getElementById('winnerSignature');
            const signature = signatureInput.value.trim();
            
            if (!signature) {
                alert('Pros√≠m, zadejte sv≈Øj podpis!');
                return;
            }
            
            // Vytvo≈ô v√Ωsledek hry
            const gameEndTime = new Date();
            const gameDurationMs = gameEndTime - (gameState.gameStartTime || gameEndTime);
            const gameDurationMinutes = Math.round(gameDurationMs / 60000);
            
            const gameResult = {
                date: gameEndTime.toISOString(),
                signature: signature,
                targetScore: parseInt(document.getElementById('targetScoreInput').value),
                finalScore: gameState.players[0].score,
                gameDuration: gameDurationMinutes,
                totalTurns: gameState.currentTurn || 1,
                pointsPerTurn: Math.round(gameState.players[0].score / (gameState.currentTurn || 1)),
                allScores: gameState.players.map(p => ({ name: p.name, score: p.score }))
            };
            
            saveToHallOfFame(gameResult);
            
            // Automaticky zobrazit s√≠≈à sl√°vy po ulo≈æen√≠
            setTimeout(() => {
                displayHallOfFame();
            }, 500);
        };
        
        window.startNewGame = function() {
            document.getElementById('gameOverModal').style.display = 'none';
            // Reset game state
            location.reload();
        };
        
        window.returnToMainMenu = function() {
            document.getElementById('gameOverModal').style.display = 'none';
            document.getElementById('gameControls').style.display = 'none';
            document.getElementById('targetScoreSetup').style.display = 'block';
        };
        
        function showGameOverModal(winner) {
            const winnerPlayer = gameState.players.find(p => p.type === winner);
            
            document.getElementById('winnerAnnouncement').innerHTML = 
                winner === 'human' ? 'üéâ Gratulujeme! Vyhr√°li jste!' : `üèÜ V√≠tƒõzem se st√°v√° ${winnerPlayer.name}!`;
            
            let finalScoresHTML = '<strong>Koneƒçn√© sk√≥re:</strong><br>';
            gameState.players.forEach(player => {
                finalScoresHTML += `${player.name}: ${player.score.toLocaleString()} bod≈Ø<br>`;
            });
            document.getElementById('finalScores').innerHTML = finalScoresHTML;
            
            const gameEndTime = new Date();
            const gameDurationMinutes = Math.round((gameEndTime - (gameState.gameStartTime || gameEndTime)) / 60000);
            document.getElementById('gameStats').innerHTML = `
                <strong>Statistiky hry:</strong><br>
                ‚è±Ô∏è Doba hry: ${gameDurationMinutes} min<br>
                üîÑ Poƒçet tah≈Ø: ${gameState.currentTurn || 1}<br>
                üéØ C√≠lov√© sk√≥re: ${parseInt(document.getElementById('targetScoreInput').value).toLocaleString()} bod≈Ø
            `;
            
            // Zobrazit signature sekci pouze pro lidsk√© v√≠tƒõze
            if (winner === 'human') {
                document.getElementById('signatureSection').style.display = 'block';
            } else {
                document.getElementById('signatureSection').style.display = 'none';
            }
            
            document.getElementById('gameOverModal').style.display = 'block';
        }
    </script>
</body>
</html>
