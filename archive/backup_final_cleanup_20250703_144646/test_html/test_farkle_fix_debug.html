<!DOCTYPE html>
<html lang="cs">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>🎲 Test Farkle Fix</title>
    <style>
        body {
            font-family: 'Courier New', monospace;
            background: #000;
            color: #00ff41;
            margin: 20px;
            line-height: 1.6;
        }
        .test-section {
            border: 2px solid #00ff41;
            margin: 20px 0;
            padding: 15px;
            border-radius: 8px;
        }
        .console-output {
            background: #111;
            border: 1px solid #333;
            padding: 10px;
            height: 300px;
            overflow-y: auto;
            font-size: 12px;
            margin-top: 10px;
        }
        button {
            background: #00ff41;
            color: #000;
            border: none;
            padding: 10px 20px;
            margin: 5px;
            cursor: pointer;
            border-radius: 4px;
            font-weight: bold;
        }
        .critical {
            color: #ff3333;
            font-weight: bold;
        }
        .success {
            color: #00ff41;
            font-weight: bold;
        }
        .info {
            color: #ffff00;
        }
    </style>
</head>
<body>
    <h1>🎲 Test Farkle Fix - Debugging</h1>
    
    <div class="test-section">
        <h2>🔧 Status Oprav</h2>
        <div class="success">✅ Přidáno podrobné debug logging</div>
        <div class="success">✅ Opraveny potenciální problémy s currentTurnScore</div>
        <div class="success">✅ Přidány safeguards proti zaseknutí AI</div>
        <div class="success">✅ Vyřešeno npm/pnpm varování</div>
        
        <h3>🎯 Co bylo opraveno:</h3>
        <ul>
            <li><strong>bankSelectedDice()</strong> - Přidáno detailní logování pro sledování skóre</li>
            <li><strong>endTurn()</strong> - Debug informace o přenosu skóre mezi hráči</li>
            <li><strong>AI logika</strong> - Podrobné logy pro AI rozhodování a bankovní logiku</li>
            <li><strong>playerTurn()</strong> - Reset kontroly pro currentTurnScore</li>
            <li><strong>Game state</strong> - Bezpečnostní resety a kontroly</li>
        </ul>
    </div>
    
    <div class="test-section">
        <h2>🎮 Testovací Instructions</h2>
        <div class="info">
            1. Otevřete hru v hlavním okně<br>
            2. Otevřete Developer Tools (F12)<br>
            3. Odložte nějaké kostky (např. 1050 bodů)<br>
            4. Sledujte konzoli pro detailní debug informace<br>
            5. Zkontrolujte, že se skóre správně přenáší mezi hráči
        </div>
        
        <h3>🔍 Co sledovat v konzoli:</h3>
        <ul>
            <li><span class="critical">🏦 === BANKING DICE START ===</span> - Začátek bankovního procesu</li>
            <li><span class="info">💰 Current turn score AFTER adding:</span> - Skóre po přidání</li>
            <li><span class="critical">🎯 === ENDTURN START ===</span> - Začátek ukončení tahu</li>
            <li><span class="info">💰 SCORE ADDED:</span> - Přidání skóre k celkovému skóre hráče</li>
            <li><span class="critical">🤖 === AI TURN START ===</span> - Začátek AI tahu</li>
            <li><span class="info">🧠 === AI DECISION START ===</span> - AI rozhodování</li>
        </ul>
    </div>
    
    <div class="test-section">
        <h2>📊 Quick Test Console</h2>
        <button onclick="showDebugInfo()">Show Game State</button>
        <button onclick="clearConsole()">Clear Console</button>
        <div id="consoleOutput" class="console-output"></div>
    </div>

    <script>
        const consoleOutput = document.getElementById('consoleOutput');
        
        // Capture console logs
        const originalLog = console.log;
        const originalWarn = console.warn;
        const originalError = console.error;
        
        function addToConsole(message, type = 'log') {
            const timestamp = new Date().toLocaleTimeString();
            const div = document.createElement('div');
            div.innerHTML = `[${timestamp}] ${message}`;
            
            switch(type) {
                case 'warn':
                    div.style.color = '#ffff00';
                    break;
                case 'error':
                    div.style.color = '#ff3333';
                    break;
                default:
                    div.style.color = '#00ff41';
            }
            
            consoleOutput.appendChild(div);
            consoleOutput.scrollTop = consoleOutput.scrollHeight;
        }
        
        console.log = function(...args) {
            originalLog.apply(console, args);
            addToConsole(args.join(' '), 'log');
        };
        
        console.warn = function(...args) {
            originalWarn.apply(console, args);
            addToConsole(args.join(' '), 'warn');
        };
        
        console.error = function(...args) {
            originalError.apply(console, args);
            addToConsole(args.join(' '), 'error');
        };
        
        function showDebugInfo() {
            console.log('🔍 === DEBUG INFO ===');
            console.log('Current URL:', window.location.href);
            console.log('Time:', new Date().toISOString());
            console.log('User Agent:', navigator.userAgent);
            
            // Try to access game state if available
            if (window.gameState) {
                console.log('🎮 Game State Available:');
                console.log('Current Player:', window.gameState.currentPlayer);
                console.log('Current Turn Score:', window.gameState.currentTurnScore);
                console.log('Players:', window.gameState.players.map(p => `${p.name}: ${p.score}`));
            } else {
                console.log('❌ Game State not available in this window');
            }
        }
        
        function clearConsole() {
            consoleOutput.innerHTML = '';
            console.log('🧹 Console cleared');
        }
        
        // Initial message
        console.log('🎲 Farkle Fix Test Page loaded');
        console.log('📊 Ready to monitor game debugging');
    </script>
</body>
</html>
