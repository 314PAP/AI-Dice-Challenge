<!DOCTYPE html>
<html lang="cs">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test Chat AI + Scrollbar</title>
    
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
    
    <!-- CSS promƒõnn√© -->
    <link rel="stylesheet" href="/src/styles/variables/colors.css">
    <link rel="stylesheet" href="/src/styles/utils/neon-bootstrap-utilities.css">
    <link rel="stylesheet" href="/src/styles/components/chat.css">
    <link rel="stylesheet" href="/src/styles/components/bootstrap-responsive.css">
    
    <style>
        body {
            background-color: #000;
            color: #fff;
            font-family: 'JetBrains Mono', monospace;
            padding: 20px;
        }
        
        .test-container {
            max-width: 800px;
            margin: 0 auto;
        }
        
        .chat-test-box {
            background-color: #111;
            border: 2px solid var(--neon-green);
            border-radius: 10px;
            height: 400px;
            display: flex;
            flex-direction: column;
        }
        
        .chat-header {
            background-color: #1a1a1a;
            padding: 10px;
            border-bottom: 1px solid var(--neon-green);
            text-align: center;
        }
        
        .chat-messages {
            flex: 1;
            overflow-y: auto;
            padding: 10px;
            min-height: 0;
            scrollbar-width: thin;
            scrollbar-color: var(--neon-green) rgba(0, 0, 0, 0.3);
        }
        
        .chat-messages::-webkit-scrollbar {
            width: 8px;
        }
        
        .chat-messages::-webkit-scrollbar-track {
            background: rgba(0, 0, 0, 0.3);
            border-radius: 4px;
        }
        
        .chat-messages::-webkit-scrollbar-thumb {
            background: var(--neon-green);
            border-radius: 4px;
        }
        
        .chat-messages::-webkit-scrollbar-thumb:hover {
            background: var(--neon-blue);
        }
        
        .chat-message {
            margin-bottom: 8px;
            padding: 8px;
            border-radius: 5px;
            background-color: rgba(0, 0, 0, 0.3);
        }
        
        .chat-input-area {
            padding: 10px;
            background-color: #1a1a1a;
            border-top: 1px solid var(--neon-green);
            display: flex;
            gap: 10px;
        }
        
        .chat-input {
            flex: 1;
            background-color: #000;
            border: 1px solid var(--neon-green);
            color: var(--neon-green);
            padding: 8px;
            border-radius: 5px;
        }
        
        .test-buttons {
            margin: 20px 0;
            text-align: center;
        }
        
        .test-buttons button {
            margin: 5px;
        }
        
        .claude-stats {
            background-color: #1a1a1a;
            border: 1px solid var(--neon-orange);
            padding: 10px;
            border-radius: 5px;
            margin: 10px 0;
        }
    </style>
</head>
<body>
    <div class="test-container">
        <h1 class="text-center mb-4 neon-text-green">üß™ Test Chat + Scrollbar</h1>
        
        <div class="claude-stats">
            <h5 class="neon-text-orange">üìä Claude Statistiky</h5>
            <div>Poƒçet zpr√°v Claude: <span id="claudeCount" class="neon-text-orange">0</span></div>
            <div>Celkem zpr√°v AI: <span id="aiTotalCount" class="neon-text-blue">0</span></div>
            <div>Claude procenta: <span id="claudePercentage" class="neon-text-yellow">0%</span></div>
        </div>
        
        <div class="chat-test-box">
            <div class="chat-header">
                <h5 class="neon-text-green mb-0">üí¨ Chat Test</h5>
            </div>
            
            <div class="chat-messages" id="chatMessages">
                <!-- Zpr√°vy se p≈ôidaj√≠ zde -->
            </div>
            
            <div class="chat-input-area">
                <input type="text" class="chat-input" id="chatInput" placeholder="Napi≈°te zpr√°vu...">
                <button class="btn btn-outline-success btn-sm" onclick="sendMessage()">
                    üì§ Odeslat
                </button>
            </div>
        </div>
        
        <div class="test-buttons">
            <button class="btn btn-outline-primary btn-sm" onclick="testClaudeSpecifically()">
                üß† Test Claude p≈ô√≠mo
            </button>
            <button class="btn btn-outline-success btn-sm" onclick="addManyMessages()">
                üìú Naplnit chat (test scrollbar)
            </button>
            <button class="btn btn-outline-warning btn-sm" onclick="testAllAI()">
                ü§ñ Test v≈°ech AI (5x)
            </button>
            <button class="btn btn-outline-danger btn-sm" onclick="clearChat()">
                üóëÔ∏è Vyƒçistit
            </button>
        </div>
        
        <div class="mt-3 small">
            <strong>Instrukce:</strong>
            <ul>
                <li>Napi≈°te zpr√°vu a ode≈°lete pro test AI odpovƒõd√≠</li>
                <li>Pou≈æijte "Naplnit chat" pro test scrollbaru</li>
                <li>Sledujte Claude statistiky - mƒõl by odpov√≠dat</li>
            </ul>
        </div>
    </div>

    <script type="module">
        import { generateAIChatResponse } from '/src/js/ai/aiController.js';
        
        let claudeCount = 0;
        let aiTotalCount = 0;
        
        function updateStats() {
            document.getElementById('claudeCount').textContent = claudeCount;
            document.getElementById('aiTotalCount').textContent = aiTotalCount;
            const percentage = aiTotalCount > 0 ? Math.round((claudeCount / aiTotalCount) * 100) : 0;
            document.getElementById('claudePercentage').textContent = percentage + '%';
        }
        
        function addChatMessage(sender, message, colorClass = 'neon-green') {
            const chatMessages = document.getElementById('chatMessages');
            
            const messageElement = document.createElement('div');
            messageElement.className = 'chat-message';
            messageElement.innerHTML = `
                <strong class="${colorClass}">${sender}:</strong> 
                <span class="${colorClass}">${message}</span>
            `;
            
            chatMessages.appendChild(messageElement);
            chatMessages.scrollTop = chatMessages.scrollHeight;
        }
        
        function sendMessage() {
            const input = document.getElementById('chatInput');
            const message = input.value.trim();
            
            if (!message) return;
            
            // P≈ôidat zpr√°vu hr√°ƒçe
            addChatMessage('Hr√°ƒç', message, 'neon-green');
            input.value = '';
            
            // Test AI odpovƒõd√≠
            const aiTypes = ['gemini', 'chatgpt', 'claude'];
            const playerScores = { player: 0, gemini: 0, chatgpt: 0, claude: 0 };
            const targetScore = 10000;
            
            // 80% ≈°ance jedna AI, 20% dvƒõ AI
            const numResponding = Math.random() < 0.8 ? 1 : 2;
            const respondingAIs = aiTypes.sort(() => Math.random() - 0.5).slice(0, numResponding);
            
            respondingAIs.forEach((aiType, index) => {
                setTimeout(() => {
                    const aiResponse = generateAIChatResponse(aiType, message, playerScores, targetScore);
                    
                    if (aiResponse && aiResponse.message) {
                        let colorClass = 'neon-blue';
                        let aiName = 'AI';
                        
                        switch(aiType) {
                            case 'gemini': 
                                colorClass = 'neon-blue'; 
                                aiName = 'Gemini';
                                break;
                            case 'chatgpt': 
                                colorClass = 'neon-pink'; 
                                aiName = 'ChatGPT';
                                break;
                            case 'claude': 
                                colorClass = 'neon-orange'; 
                                aiName = 'Claude';
                                claudeCount++;
                                break;
                        }
                        
                        aiTotalCount++;
                        addChatMessage(aiName, aiResponse.message, colorClass);
                        updateStats();
                    }
                }, 500 + (index * 800));
            });
        }
        
        function testClaudeSpecifically() {
            const playerScores = { player: 0, gemini: 0, chatgpt: 0, claude: 0 };
            const aiResponse = generateAIChatResponse('claude', 'ahoj', playerScores, 10000);
            
            if (aiResponse && aiResponse.message) {
                claudeCount++;
                aiTotalCount++;
                addChatMessage('Claude', aiResponse.message, 'neon-orange');
                updateStats();
            } else {
                addChatMessage('Test', 'Claude neodpovƒõdƒõl (probl√©m s modulem)', 'neon-red');
            }
        }
        
        function addManyMessages() {
            const sampleMessages = [
                { sender: 'Hr√°ƒç', message: 'Test zpr√°va #', color: 'neon-green' },
                { sender: 'Gemini', message: 'Odpovƒõƒè Gemini #', color: 'neon-blue' },
                { sender: 'ChatGPT', message: 'ChatGPT reaguje #', color: 'neon-pink' },
                { sender: 'Claude', message: 'Claude filosofuje #', color: 'neon-orange' },
                { sender: 'Syst√©m', message: 'Syst√©mov√° zpr√°va #', color: 'neon-yellow' }
            ];
            
            for (let i = 1; i <= 20; i++) {
                const msg = sampleMessages[i % sampleMessages.length];
                setTimeout(() => {
                    addChatMessage(msg.sender, msg.message + i, msg.color);
                }, i * 100);
            }
        }
        
        function testAllAI() {
            const aiTypes = ['gemini', 'chatgpt', 'claude'];
            const playerScores = { player: 0, gemini: 0, chatgpt: 0, claude: 0 };
            const messages = ['ahoj', 'jak se m√°te?', 'dobr√Ω tah', 'super hra', 'moudr√© rozhodnut√≠'];
            
            for (let round = 0; round < 5; round++) {
                aiTypes.forEach((aiType, aiIndex) => {
                    setTimeout(() => {
                        const message = messages[round % messages.length];
                        const aiResponse = generateAIChatResponse(aiType, message, playerScores, 10000);
                        
                        if (aiResponse && aiResponse.message) {
                            let colorClass = 'neon-blue';
                            let aiName = 'AI';
                            
                            switch(aiType) {
                                case 'gemini': 
                                    colorClass = 'neon-blue'; 
                                    aiName = 'Gemini';
                                    break;
                                case 'chatgpt': 
                                    colorClass = 'neon-pink'; 
                                    aiName = 'ChatGPT';
                                    break;
                                case 'claude': 
                                    colorClass = 'neon-orange'; 
                                    aiName = 'Claude';
                                    claudeCount++;
                                    break;
                            }
                            
                            aiTotalCount++;
                            addChatMessage(aiName, aiResponse.message, colorClass);
                            updateStats();
                        }
                    }, (round * 3 + aiIndex) * 600);
                });
            }
        }
        
        function clearChat() {
            document.getElementById('chatMessages').innerHTML = '';
            claudeCount = 0;
            aiTotalCount = 0;
            updateStats();
        }
        
        // Event listener pro Enter v input
        document.getElementById('chatInput').addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                sendMessage();
            }
        });
        
        // Glob√°ln√≠ funkce pro window
        window.sendMessage = sendMessage;
        window.testClaudeSpecifically = testClaudeSpecifically;
        window.addManyMessages = addManyMessages;
        window.testAllAI = testAllAI;
        window.clearChat = clearChat;
        
        // √övodn√≠ zpr√°va
        addChatMessage('Test', 'Chat p≈ôipraven! Zkuste napsat zpr√°vu...', 'neon-yellow');
    </script>
</body>
</html>
