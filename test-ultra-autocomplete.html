<!DOCTYPE html>
<html lang="cs">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Test Ultra Bootstrap Autocomplete</title>
    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- Bootstrap Icons -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.3/font/bootstrap-icons.css" rel="stylesheet">
    <!-- Our CSS -->
    <link rel="stylesheet" href="src/styles/bootstrap-first-pure.css">
</head>
<body class="bg-black">
    <div class="container py-5">
        <div class="row justify-content-center">
            <div class="col-lg-8">
                <h1 class="text-neon-green text-center mb-5">
                    <i class="bi bi-search"></i> Ultra Bootstrap Autocomplete Test
                </h1>
                
                <!-- Test chat input - desktop -->
                <div class="mb-4 p-4 border border-neon-blue rounded-3 bg-neon-blue">
                    <h3 class="text-neon-blue mb-3">
                        <i class="bi bi-laptop"></i> Desktop Chat Input
                    </h3>
                    <div class="input-group">
                        <input type="text" id="testChatInput" 
                               class="form-control bg-black text-neon-blue border-neon-blue" 
                               placeholder="Napište zprávu AI..." 
                               autocomplete="off">
                        <button class="btn btn-neon-green" onclick="sendTestMessage()">
                            <i class="bi bi-send-fill"></i> Odeslat
                        </button>
                    </div>
                </div>
                
                <!-- Test chat input - mobile style -->
                <div class="mb-4 p-4 border border-neon-orange rounded-3 bg-neon-orange">
                    <h3 class="text-neon-orange mb-3">
                        <i class="bi bi-phone"></i> Mobile Chat Input
                    </h3>
                    <div class="input-group input-group-sm">
                        <input type="text" id="testChatInputMobile" 
                               class="form-control bg-black text-neon-blue border-neon-blue" 
                               placeholder="Zpráva..." 
                               autocomplete="off">
                        <button class="btn btn-neon-orange btn-sm" onclick="sendTestMessageMobile()">
                            <i class="bi bi-send-fill"></i>
                        </button>
                    </div>
                </div>
                
                <!-- Chat historie -->
                <div class="p-4 border border-neon-pink rounded-3 bg-neon-pink">
                    <h3 class="text-neon-pink mb-3">
                        <i class="bi bi-clock-history"></i> Chat Historie
                    </h3>
                    <div id="chatHistory" class="bg-black rounded-2 p-3 text-light" style="min-height: 200px; max-height: 300px; overflow-y: auto;">
                        <p class="text-muted">Sem se budou přidávat odeslané zprávy...</p>
                    </div>
                    <div class="mt-3">
                        <button class="btn btn-neon-red btn-sm" onclick="clearHistory()">
                            <i class="bi bi-trash"></i> Vymazat historii
                        </button>
                        <button class="btn btn-neon-yellow btn-sm" onclick="addSampleData()">
                            <i class="bi bi-plus-circle"></i> Přidat vzorová data
                        </button>
                    </div>
                </div>
                
                <!-- Instructions -->
                <div class="mt-4 alert alert-neon-green">
                    <h5 class="text-neon-green mb-2">
                        <i class="bi bi-info-circle"></i> Návod k testování:
                    </h5>
                    <ul class="text-neon-green mb-0">
                        <li>Začněte psát do input polí - zobrazí se autocomplete dropdown</li>
                        <li>Použijte šipky ↑↓ pro navigaci v seznamu</li>
                        <li>Stiskněte Enter pro výběr nebo Escape pro zavření</li>
                        <li>Odeslané zprávy se automaticky přidají do autocomplete historie</li>
                        <li>Historie je sdílená mezi desktop a mobile verzí</li>
                    </ul>
                </div>
            </div>
        </div>
    </div>

    <!-- Ultra Bootstrap Autocomplete -->
    <script src="src/ultra-bootstrap-autocomplete.js"></script>
    
    <script>
        let desktopAutocomplete, mobileAutocomplete;
        let chatMessages = [];
        
        // Inicializace po načtení DOM
        document.addEventListener('DOMContentLoaded', function() {
            // Desktop autocomplete
            const desktopInput = document.getElementById('testChatInput');
            if (desktopInput) {
                desktopAutocomplete = new UltraBootstrapAutocomplete(desktopInput, {
                    suggestions: getSampleSuggestions(),
                    neonColor: 'blue',
                    storageKey: 'test-chat-history',
                    maxResults: 8,
                    placeholder: 'Napište zprávu AI...'
                });
            }
            
            // Mobile autocomplete
            const mobileInput = document.getElementById('testChatInputMobile');
            if (mobileInput) {
                mobileAutocomplete = new UltraBootstrapAutocomplete(mobileInput, {
                    suggestions: getSampleSuggestions(),
                    neonColor: 'blue',
                    storageKey: 'test-chat-history',
                    maxResults: 6,
                    placeholder: 'Zpráva...'
                });
            }
            
            // Enter key support
            desktopInput.addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    sendTestMessage();
                }
            });
            
            mobileInput.addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    sendTestMessageMobile();
                }
            });
            
            console.log('✅ Test autocomplete initialized!');
        });
        
        function getSampleSuggestions() {
            return [
                "Ahoj, jak se máš?",
                "Dobrý den!",
                "Jak se dnes daří?",
                "Skvělá hra!",
                "To byl dobrý tah!",
                "Štěstí ti přeje",
                "Měj se hezky",
                "Jak se ti líbí tato hra?",
                "Jaká je tvoje strategie?",
                "Myslíš si, že vyhraju?"
            ];
        }
        
        function sendTestMessage() {
            const input = document.getElementById('testChatInput');
            const message = input.value.trim();
            
            if (message) {
                addChatMessage(message, 'Hráč', 'neon-green');
                
                // Add to autocomplete
                desktopAutocomplete.addSuggestion(message);
                mobileAutocomplete.addSuggestion(message);
                
                input.value = '';
                
                // Simulate AI response
                setTimeout(() => {
                    const aiResponses = [
                        "Zajímavé, řekni mi víc!",
                        "Hmm, to je dobrá otázka.",
                        "Souhlasím s tebou!",
                        "To je skvělé pozorování."
                    ];
                    const randomResponse = aiResponses[Math.floor(Math.random() * aiResponses.length)];
                    addChatMessage(randomResponse, 'AI', 'neon-blue');
                }, 1000);
            }
        }
        
        function sendTestMessageMobile() {
            const input = document.getElementById('testChatInputMobile');
            const message = input.value.trim();
            
            if (message) {
                addChatMessage(message, 'Hráč (Mobile)', 'neon-orange');
                
                // Add to autocomplete
                desktopAutocomplete.addSuggestion(message);
                mobileAutocomplete.addSuggestion(message);
                
                input.value = '';
            }
        }
        
        function addChatMessage(message, sender, color) {
            chatMessages.push({ message, sender, color, time: new Date() });
            updateChatDisplay();
        }
        
        function updateChatDisplay() {
            const chatDiv = document.getElementById('chatHistory');
            chatDiv.innerHTML = '';
            
            chatMessages.forEach(msg => {
                const messageDiv = document.createElement('div');
                messageDiv.className = `mb-2 p-2 border-start border-3 border-${msg.color}`;
                messageDiv.innerHTML = `
                    <div class="d-flex justify-content-between align-items-start">
                        <span class="text-${msg.color} fw-bold">${msg.sender}:</span>
                        <small class="text-muted">${msg.time.toLocaleTimeString()}</small>
                    </div>
                    <div class="text-light mt-1">${msg.message}</div>
                `;
                chatDiv.appendChild(messageDiv);
            });
            
            // Scroll to bottom
            chatDiv.scrollTop = chatDiv.scrollHeight;
        }
        
        function clearHistory() {
            chatMessages = [];
            updateChatDisplay();
            
            // Clear autocomplete
            if (desktopAutocomplete) desktopAutocomplete.clear();
            if (mobileAutocomplete) mobileAutocomplete.clear();
            
            // Add back sample data
            setTimeout(() => {
                addSampleData();
            }, 500);
        }
        
        function addSampleData() {
            const samples = getSampleSuggestions();
            
            if (desktopAutocomplete) {
                desktopAutocomplete.setSuggestions(samples);
            }
            if (mobileAutocomplete) {
                mobileAutocomplete.setSuggestions(samples);
            }
        }
    </script>
</body>
</html>
